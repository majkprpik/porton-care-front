<!-- Toggle Button - Outside of all containers for maximum visibility -->
<!-- <div class="drawer-toggle" (click)="toggleDrawer()" title="Toggle Sidebar">
  <i class="fas" [ngClass]="isDrawerCollapsed ? 'fa-bars' : 'fa-angle-double-right'"></i>
</div> -->

<div class="main-container" [ngClass]="{'drawer-open': !isDrawerCollapsed}">
  <!-- Status Summary Bar - Positioned at the top of the page, but not sticky -->
  <div class="status-summary-bar">
    <div class="status-item">
      <span class="status-value">25.03.2025</span>
    </div>
    <div class="status-divider">/</div>
    <div class="status-item">
      <span class="status-value">45</span>
      <span class="status-label">KUCICA</span>
    </div>
    <div class="status-divider">/</div>
    <div class="status-item">
      <span class="status-value">21</span>
      <span class="status-label">SLOBODNA</span>
    </div>
    <div class="status-divider">/</div>
    <div class="status-item">
      <span class="status-value">24</span>
      <span class="status-label">ZAUZETE</span>
    </div>
    <div class="status-divider">/</div>
    <div class="status-item">
      <span class="status-value">12</span>
      <span class="status-label">ODLAZAKA</span>
    </div>
    <div class="status-divider">/</div>
    <div class="status-item dolazaka-special">
      <div class="dolazaka-top">
        <span class="status-value">19</span>
        <span class="status-label">DOLAZAKA</span>
      </div>
      <div class="ociscenih-label">15 OCISCENIH</div>
    </div>
  </div>

  <div class="houses-container">
    <!-- View Toggle Buttons -->
    <div class="view-toggle-buttons">
      <button class="view-button" [ngClass]="{'active': viewType === 'list'}" (click)="viewType = 'list'" title="List View">
        <i class="fas fa-list"></i>
      </button>
      <button class="view-button" [ngClass]="{'active': viewType === 'grid'}" (click)="viewType = 'grid'" title="Grid View">
        <i class="fas fa-th"></i>
      </button>
      
      <div class="search-container">
        <input 
          type="text" 
          class="house-search" 
          placeholder="Pretraži kućice..." 
          [(ngModel)]="searchQuery" 
          (input)="filterHouses()"
        >
      </div>
    </div>

    <!-- Houses layout with categorized rows (LIST VIEW) -->
    <div class="houses-wrapper" *ngIf="viewType === 'list'">
      <!-- Get filtered and sorted homes -->
      <ng-container *ngIf="getCategorizedHomes() as categorizedHomes">
        <!-- Row 3: Houses with tasks in progress -->
        <div class="house-category-row" *ngIf="categorizedHomes.inProgressHomes.length > 0">
          <div class="category-header in-progress">
            <div class="category-label">U tijeku ({{categorizedHomes.inProgressHomes.length}})</div>
          </div>
          <div class="houses-row in-progress">
            <div>
              <app-mobile-home-card 
                *ngFor="let house of categorizedHomes.inProgressHomes" 
                [mobileHome]="house">
              </app-mobile-home-card>
            </div>
          </div>
        </div>
        
        <!-- Row 4: Other houses -->
        <div class="house-category-row" *ngIf="categorizedHomes.othersHomes.length > 0">
          <div class="category-header">
            <div class="category-label">Dodjeljeno ({{getTotalAssignedTasks()}} zadataka / {{categorizedHomes.othersHomes.length}} kućica)</div>
          </div>
          <div class="houses-row">
            <app-mobile-home-card 
              *ngFor="let house of categorizedHomes.othersHomes" 
              [mobileHome]="house">
            </app-mobile-home-card>
          </div>
        </div>
  
        <div class="house-category-row" *ngIf="categorizedHomes.freeHomes.length > 0 || categorizedHomes.occupiedNoTasksHomes.length > 0">
          <div class="category-header">
            <div class="category-label">Ostale (Slobodne: {{categorizedHomes.freeHomes.length}}, Zauzete: {{categorizedHomes.occupiedNoTasksHomes.length}})</div>
          </div>
          <div class="houses-row">
            <app-mobile-home-card 
              *ngFor="let house of categorizedHomes.freeHomes" 
              [mobileHome]="house">
            </app-mobile-home-card>
            <app-mobile-home-card 
            *ngFor="let house of categorizedHomes.occupiedNoTasksHomes" 
            [mobileHome]="house">
          </app-mobile-home-card>
          </div>
        </div>
      </ng-container>
    </div>

    <!-- GRID VIEW: All houses sorted by number -->
    <div class="houses-wrapper grid-view" *ngIf="viewType === 'grid'">
      <div class="houses-grid">
        <app-mobile-home-card 
          *ngFor="let house of getAllHomesSorted()" 
          [mobileHome]="house">
        </app-mobile-home-card>
      </div>
    </div>
  </div>

  <!-- Side Drawer -->
  <div class="side-drawer" [ngClass]="{'collapsed': isDrawerCollapsed}">
    <div class="drawer-content">
      <div class="sidebar-tabs">
        <div class="tab-navigation">
          <div class="tab-button" [ngClass]="{'active': activeTab === 'tasks'}" (click)="setActiveTab('tasks')">
            <i class="fas fa-tasks"></i>
            <span>Timovi</span>
          </div>
          <div class="tab-button" [ngClass]="{'active': activeTab === 'info'}" (click)="setActiveTab('info')">
            <i class="fas fa-info-circle"></i>
            <span>Informacije</span>
          </div>
          <div class="tab-button" [ngClass]="{'active': activeTab === 'settings'}" (click)="setActiveTab('settings')">
            <i class="fas fa-cog"></i>
            <span>Postavke</span>
          </div>
        </div>
        
        <div class="tab-content">
          <!-- Tab 1: Info -->
          <div *ngIf="activeTab === 'info'" class="tab-pane">
            
            <!-- Activity Feed -->
            <app-news-feed></app-news-feed>
          </div>
          
          <!-- Tab 2: Tasks -->
          <div *ngIf="activeTab === 'tasks'" class="tab-pane">
            <!-- <h3>Timovi</h3> -->
            <div class="teams-container">
              <!-- Team Card: Spremacice 1 -->
              <div class="team-card">
                <div class="team-header">
                  <div class="team-name">Spremacice 1</div>
                  <div class="team-status active">Kućica 301 <i class="fas fa-broom"></i></div>
                </div>
                <div class="team-members">
                  <div class="team-member">
                    <i class="fas fa-user"></i>
                    <span>Ana Marić</span>
                  </div>
                  <div class="team-member">
                    <i class="fas fa-user"></i>
                    <span>Mira Horvat</span>
                  </div>
                  <div class="team-member">
                    <i class="fas fa-user"></i>
                    <span>Josipa Knežević</span>
                  </div>
                </div>
                <div class="team-tasks">
                  <div class="task-label">Zadaci:</div>
                  <div class="task-badges">
                    <div class="task-badge" title="Kućica 301, Čišćenje">
                      <span class="house-number">301</span>
                      <i class="fas fa-broom"></i>
                    </div>
                    <div class="task-badge" title="Kućica 408, Čišćenje">
                      <span class="house-number">408</span>
                      <i class="fas fa-broom"></i>
                    </div>
                    <div class="task-badge" title="Kućica 523, Čišćenje">
                      <span class="house-number">523</span>
                      <i class="fas fa-broom"></i>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- Team Card: Spremacice 2 -->
              <div class="team-card">
                <div class="team-header">
                  <div class="team-name">Spremacice 2</div>
                  <div class="team-status active">Kućica 203 <i class="fas fa-broom"></i></div>
                </div>
                <div class="team-members">
                  <div class="team-member">
                    <i class="fas fa-user"></i>
                    <span>Ivana Perić</span>
                  </div>
                  <div class="team-member">
                    <i class="fas fa-user"></i>
                    <span>Marina Vukić</span>
                  </div>
                </div>
                <div class="team-tasks">
                  <div class="task-label">Zadaci:</div>
                  <div class="task-badges">
                    <div class="task-badge" title="Kućica 203, Čišćenje">
                      <span class="house-number">203</span>
                      <i class="fas fa-broom"></i>
                    </div>
                    <div class="task-badge" title="Kućica 205, Čišćenje">
                      <span class="house-number">205</span>
                      <i class="fas fa-broom"></i>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- Team Card: Terasari -->
              <div class="team-card">
                <div class="team-header">
                  <div class="team-name">Terasari</div>
                  <div class="team-status active">Kućica 401 <i class="fas fa-umbrella-beach"></i></div>
                </div>
                <div class="team-members">
                  <div class="team-member">
                    <i class="fas fa-user"></i>
                    <span>Marko Kovač</span>
                  </div>
                  <div class="team-member">
                    <i class="fas fa-user"></i>
                    <span>Ante Bakić</span>
                  </div>
                  <div class="team-member">
                    <i class="fas fa-user"></i>
                    <span>Nikola Šimić</span>
                  </div>
                </div>
                <div class="team-tasks">
                  <div class="task-label">Zadaci:</div>
                  <div class="task-badges">
                    <div class="task-badge" title="Kućica 401, Terasa">
                      <span class="house-number">401</span>
                      <i class="fas fa-umbrella-beach"></i>
                    </div>
                    <div class="task-badge" title="Kućica 409, Terasa">
                      <span class="house-number">409</span>
                      <i class="fas fa-umbrella-beach"></i>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- Team Card: Majstori -->
              <div class="team-card">
                <div class="team-header">
                  <div class="team-name">Majstori</div>
                  <div class="team-status active">Kućica 402 <i class="fas fa-tools"></i></div>
                </div>
                <div class="team-members">
                  <div class="team-member">
                    <i class="fas fa-user"></i>
                    <span>Ivan Jurić</span>
                  </div>
                  <div class="team-member">
                    <i class="fas fa-user"></i>
                    <span>Tomislav Novak</span>
                  </div>
                </div>
                <div class="team-tasks">
                  <div class="task-label">Zadaci:</div>
                  <div class="task-badges">
                    <div class="task-badge" title="Kućica 402, Popravak">
                      <span class="house-number">402</span>
                      <i class="fas fa-tools"></i>
                    </div>
                    <div class="task-badge" title="Kućica 404, Popravak">
                      <span class="house-number">404</span>
                      <i class="fas fa-tools"></i>
                    </div>
                    <div class="task-badge" title="Kućica 413, Popravak">
                      <span class="house-number">413</span>
                      <i class="fas fa-tools"></i>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- Team Card: Recepcija -->
              <div class="team-card">
                <div class="team-header">
                  <div class="team-name">Recepcija</div>
                </div>
                <div class="team-members">
                  <div class="team-member">
                    <i class="fas fa-user"></i>
                    <span>Maja Kovačić</span>
                  </div>
                  <div class="team-member">
                    <i class="fas fa-user"></i>
                    <span>Petra Lovrić</span>
                  </div>
                  <div class="team-member">
                    <i class="fas fa-user"></i>
                    <span>Luka Vidović</span>
                  </div>
                </div>
                <!-- <div class="team-info">
                  <i class="fas fa-info-circle"></i>
                  <span>Bez dodijeljenih zadataka</span>
                </div> -->
              </div>
              
              <!-- Team Card: Customer Service -->
              <div class="team-card">
                <div class="team-header">
                  <div class="team-name">Customer Service</div>
                </div>
                <div class="team-members">
                  <div class="team-member">
                    <i class="fas fa-user"></i>
                    <span>Sara Bošnjak</span>
                  </div>
                  <div class="team-member">
                    <i class="fas fa-user"></i>
                    <span>Filip Kralj</span>
                  </div>
                </div>
                <!-- <div class="team-info">
                  <i class="fas fa-info-circle"></i>
                  <span>Bez dodijeljenih zadataka</span>
                </div> -->
              </div>
            </div>
          </div>
          
          <!-- Tab 3: Settings -->
          <div *ngIf="activeTab === 'settings'" class="tab-pane">
            <h3>Postavke</h3>
            <p>Postavke prikaza i filtriranja.</p>
            
            <!-- Sample content to test scrolling -->
            <div class="settings-section">
              <h4>Prikaz kućica</h4>
              <div class="form-check">
                <input type="checkbox" class="form-check-input" id="showFreeHouses" [(ngModel)]="showFreeHouses">
                <label class="form-check-label" for="showFreeHouses">Prikaži slobodne kućice</label>
              </div>
              <div class="form-check">
                <input type="checkbox" class="form-check-input" id="showFreeHousesWithTasks" [(ngModel)]="showFreeHousesWithTasks">
                <label class="form-check-label" for="showFreeHousesWithTasks">Prikaži slobodne kućice sa zadacima</label>
              </div>
              <div class="form-check">
                <input type="checkbox" class="form-check-input" id="showOccupiedHouses" [(ngModel)]="showOccupiedHouses">
                <label class="form-check-label" for="showOccupiedHouses">Prikaži zauzete kućice</label>
              </div>
            </div>
            
            <div class="settings-section">
              <h4>Sortiranje</h4>
              <div class="form-group">
                <label for="sortBy">Sortiraj po:</label>
                <select class="form-control" id="sortBy" [(ngModel)]="sortBy">
                  <option value="">Bez sortiranja</option>
                  <option value="number">Broju kućice</option>
                  <option value="status">Statusu</option>
                  <option value="tasks">Broju zadataka</option>
                </select>
              </div>
            </div>
            
            <div class="settings-section">
              <h4>Timovi</h4>
              <div class="form-check">
                <input type="checkbox" class="form-check-input" id="expandTeams" [(ngModel)]="areTeamBoxesExpanded">
                <label class="form-check-label" for="expandTeams">Automatski proširi timove</label>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>