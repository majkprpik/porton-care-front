<div class="daily-sheet-container">
  <!-- Left side - Mobile Homes -->
  <div class="homes-section">
    <h3>Mobile Homes</h3>
    <div
      class="homes-list"
      cdkDropList
      id="homes-list"
      [cdkDropListData]="mobileHomes"
      [cdkDropListConnectedTo]="getTeamHomeDropLists()"
      (cdkDropListDropped)="onDrop($event)"
    >
      <app-mobile-home-card
        *ngFor="let house of mobileHomes"
        [status]="house.status"
        [homeNumber]="house.number"
        [mobileHome]="house"
        [taskIndicators]="getTaskIndicators(house)"
        cdkDrag
      >
      </app-mobile-home-card>
    </div>
  </div>

  <!-- Middle - Teams -->
  <div class="teams-section">
    <h3>Teams</h3>
    <div class="button-container">
      <button class="new-team-btn" (click)="createNewTeam()">
        Create New Team
      </button>
      <button class="lock-teams-btn" (click)="lockTeams()">Lock Teams</button>
      <button class="load-default-btn" (click)="loadDefaultTeams()" *ngIf="assignedTeams.length === 0">
        Load Default Teams
      </button>
    </div>

    <div class="teams-container">
      <div *ngIf="assignedTeams.length === 0" class="no-teams-message">
        No teams found for today. Create a new team or load default teams.
      </div>
      
      <div class="team-box" *ngFor="let team of assignedTeams" [class.locked-team]="isTeamLocked(team.id)">
        <h4>Team {{ team.id }} <span *ngIf="isTeamLocked(team.id)" class="locked-indicator">ðŸ”’ Locked</span></h4>
        <div class="team-content">
          <div
            class="team-homes"
            cdkDropList
            [id]="'team-' + team.id + '-homes'"
            [cdkDropListData]="team.homes"
            [cdkDropListConnectedTo]="isTeamLocked(team.id) ? [] : ['homes-list']"
            (cdkDropListDropped)="onDrop($event)"
            [cdkDropListDisabled]="isTeamLocked(team.id)"
          >
            <app-mobile-home-card
              *ngFor="let home of team.homes"
              [status]="home.status"
              [homeNumber]="home.number"
              [mobileHome]="home"
              [taskIndicators]="getTaskIndicators(home)"
              [cdkDragDisabled]="isTeamLocked(team.id)"
              cdkDrag
            >
            </app-mobile-home-card>
            <div class="placeholder" *ngIf="team.homes.length === 0 && !isTeamLocked(team.id)">
              Drop homes here
            </div>
          </div>

          <div
            class="team-members"
            cdkDropList
            [id]="'team-' + team.id + '-members'"
            [cdkDropListData]="team.members"
            [cdkDropListConnectedTo]="isTeamLocked(team.id) ? [] : ['staff-list']"
            (cdkDropListDropped)="onDrop($event)"
            [cdkDropListDisabled]="isTeamLocked(team.id)"
          >
            <div
              class="member-card"
              *ngFor="let member of team.members"
              cdkDrag
              [cdkDragDisabled]="isTeamLocked(team.id)"
            >
              {{ member.name }}
            </div>
            <div class="placeholder" *ngIf="team.members.length === 0 && !isTeamLocked(team.id)">
              Drop staff here
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Right side - Cleaning Staff -->
  <div class="staff-section">
    <h3>Cleaning Staff</h3>
    <div
      class="staff-list"
      cdkDropList
      id="staff-list"
      [cdkDropListData]="cleaningStaff"
      [cdkDropListConnectedTo]="getTeamMemberDropLists()"
      (cdkDropListDropped)="onDrop($event)"
    >
      <div
        class="staff-card"
        *ngFor="let person of cleaningStaff"
        cdkDrag
        [class.unavailable]="!person.available"
      >
        {{ person.name }}
      </div>
    </div>
  </div>
</div>
