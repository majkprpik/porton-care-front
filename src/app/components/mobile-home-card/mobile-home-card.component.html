<div class="mobile-home-card" 
     [ngClass]="{
       'occupied': mobileHome.availabilityname === 'Occupied', 
       'free-with-tasks': mobileHome.availabilityname === 'Free' && mobileHome.housetasks.length > 0,
       'free': mobileHome.availabilityname === 'Free' && mobileHome.housetasks.length === 0,
       'expanded': expanded,
       'has-in-progress': getInProgressTask() !== null
     }"
     (click)="toggleExpansion($event)">
  
  <!-- Top row with house number and task icons (always visible) -->
  <div class="card-top-row">
    <!-- House number on the left -->
    <div class="house-info">
      <div class="house-number">{{ mobileHome.housename }}</div>
    </div>
    
    <!-- Task icons on the right -->
    <div *ngIf="getInProgressTask()" class="task-icon-corner rotating" [matTooltip]="getInProgressTask()?.taskTypeName">
      <mat-icon>{{ getTaskIcon(getInProgressTask()!) }}</mat-icon>
    </div>
    
    <div *ngIf="!getInProgressTask() && getTopRowTasks().length > 0" class="non-progress-icons">
      <!-- First task icon -->
      <div class="task-icon-corner small" *ngIf="getTopRowTasks().length > 0" 
           [matTooltip]="getTopRowTasks()[0].taskTypeName">
        <mat-icon>{{ getTaskIcon(getTopRowTasks()[0]) }}</mat-icon>
      </div>
      
      <!-- Second task icon if exists -->
      <div class="task-icon-corner small second" *ngIf="getTopRowTasks().length > 1"
           [matTooltip]="getTopRowTasks()[1].taskTypeName">
        <mat-icon>{{ getTaskIcon(getTopRowTasks()[1]) }}</mat-icon>
      </div>
    </div>
  </div>

  <!-- Reservation dates (always visible) -->

  
  <!-- Expanded content (only visible when expanded) -->
  <div class="expanded-content" *ngIf="expanded">
    <!-- Additional task icons for houses with in-progress tasks -->
    <div class="side-tasks-icons" *ngIf="getInProgressTask() && getNonProgressTasks().length > 0">
      <div *ngFor="let task of getNonProgressTasks()" 
           class="side-task-icon" 
           [matTooltip]="task.taskTypeName">
        <mat-icon>{{ getTaskIcon(task) }}</mat-icon>
      </div>
    </div>
  </div>
  
  <!-- Bottom counts section - moved outside expanded content to be always at the bottom -->
  <div class="bottom-counts" *ngIf="mobileHome.availabilityname === 'Occupied'">
    <div class="date-range">{{ '15.3 - 22.3' }}</div>
    <div class="people-counts">{{ getAdultsCount() }} | {{ getChildrenCount() }} | {{ getPetsCount() }}</div>
  </div>
</div>